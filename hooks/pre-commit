#!/bin/sh

git stash -q --keep-index

echo "ğŸ“ Running ktlintCheck..."

./gradlew ktlintCheck --daemon

RESULT=$?

if [ "$RESULT" = 0 ] ; then
    echo "âœ… ktlintCheck successful."
else
    git stash pop -q
    echo 1>&2 "ğŸš¨ ktlintCheck detected violations!"
    exit 1
fi

echo "ğŸ“ Running tests..."

./gradlew test --daemon

RESULT=$?

if [ "$RESULT" = 0 ] ; then
    echo "âœ… Tests successful."
else
    git stash pop -q
    echo 1>&2 "ğŸš¨ Tests failed!"
    exit 1
fi
